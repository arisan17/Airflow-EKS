image:
  tag: "422"
server:
  workers: 3
  exchangeManager:
    name: "filesystem"
    baseDir: "/tmp/trino-local-exchange-manager"
    # baseDir: "s3://<spool-bucket-name>"
  autoscaling:
    enabled: true
    maxReplicas: 20
    targetCPUUtilizationPercentage: 50
  config:
    query:
      maxMemory: "40GB"
service:
  # type: NodePort
  type: ClusterIP
  port: 8080
serviceAccount:
  create: false
  name: "${sa}"
coordinator:
  jvm:
    maxHeapSize: "8G"
  config:
    query:
      maxMemoryPerNode: "4GB"
  nodeSelector:
    intent: apps
    karpenter.sh/provisioner-name: trino-karpenter
    karpenter.sh/capacity-type: on-demand
worker:
  jvm:
    maxHeapSize: "8G"
  config:
    query:
      maxMemoryPerNode: "4GB"
  resources:
    # We usually recommend not to specify default resources and to leave this as a conscious
    # choice for the user. This also increases chances charts run on environments with little
    # resources, such as Minikube. If you do want to specify resources, uncomment the following
    # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
    # limits:
    #   cpu: 100m
    #   memory: 128Mi
    requests:
      cpu: 2000m
      memory: 10Gi
  nodeSelector:
    intent: apps
    karpenter.sh/provisioner-name: trino-karpenter
    karpenter.sh/capacity-type: spot
additionalConfigProperties:
  - "retry-policy=TASK"
  - "exchange.compression-enabled=true"
  - "query.low-memory-killer.delay=0s"
  - "query.remote-task.max-error-duration=1m"
  # - "query.hash-partition-count=50"
  # - "fault-tolerant-execution-target-task-input-size=4GB"
  # - "fault-tolerant-execution-target-task-split-count=64"
  # - "fault-tolerant-execution-task-memory=5GB"
  # - "task.writer-count=4"
  # - "task.concurrency=8"
  # - "scale-writers=true"
# additionalExchangeManagerProperties:
#   - "exchange.s3.region=<aws-region>"
#   - "exchange.s3.aws-access-key=<access-key>"
#   - "exchange.s3.aws-secret-key=<secret-key>"
additionalCatalogs:
  hive: |-
    connector.name=hive
    hive.metastore=glue
    hive.metastore.glue.region="${region}"
    hive.metastore.glue.default-warehouse-dir="s3://${bucket_id}"
    hive.metastore.glue.iam-role="${irsa_arn}"
    hive.s3.iam-role="${irsa_arn}"  